unit Classe.Plantio;

interface

uses
  JvSpeedButton, Classe.Functions, Classe.FunctionsSQL, Vcl.Dialogs,
  System.SysUtils;
type
        TPlantio = class

        private

        FBtNavPlantio           : TJvSpeedButton;
        FBtNavCtrlInsumos       : TJvSpeedButton;
        FBtNavImplementos       : TJvSpeedButton;
        FBtNavAreasPlantio      : TJvSpeedButton;
        FBtNavFinancas          : TJvSpeedButton;
    FKeySafra: Integer;
    procedure setKeySafra(const Value: Integer);


        public
                constructor CreateObjTPlantio;
                destructor DestroyObjTPlantio;
                procedure pHabilitaBtsNav(Btn1, Btn2, Btn3, Btn4, Btn5 : Boolean);
                function fBuscaSafraVigente : string;

        published

                property KeySafra : Integer   read FKeySafra write setKeySafra;

        end;

implementation
uses
        UFrmPlantio;

{ TPlantio }

constructor TPlantio.CreateObjTPlantio;
begin
     FBtNavPlantio      :=FrmPlantio.BtNavPlantio;
     FBtNavCtrlInsumos  :=FrmPlantio.BtNavCtrlInsumos;
     FBtNavImplementos  :=FrmPlantio.BtNavImplementos;
     FBtNavAreasPlantio :=FrmPlantio.BtNavAreasPlantio;
     FBtNavFinancas     :=FrmPlantio.BtNavFinancas;
end;

destructor TPlantio.DestroyObjTPlantio;
begin

end;

function TPlantio.fBuscaSafraVigente : string;
var
        sqlCond : string;
begin
        sqlCond := 'SELECT * FROM Safra WHERE sf_Status = ''VIGENTE''';
        Result := fMontaQryTempExec(sqlCond).FieldByName('sf_descricao').AsString;
        setKeySafra(fMontaQryTempExec(sqlCond).FieldByName('sf_IdSafra').AsInteger);
end;

procedure TPlantio.pHabilitaBtsNav(Btn1, Btn2, Btn3, Btn4, Btn5: Boolean);
begin

FBtNavPlantio.Enabled           :=      Btn1;
FBtNavCtrlInsumos.Enabled       :=      Btn2;
FBtNavImplementos.Enabled       :=      Btn3;
FBtNavAreasPlantio.Enabled      :=      Btn4;
FBtNavFinancas.Enabled          :=      Btn5;

end;

procedure TPlantio.setKeySafra(const Value: Integer);
begin
  FKeySafra := Value;
end;

end.
